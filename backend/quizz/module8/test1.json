[
  {
    "question": "Which conditions must be met for passive sniffing to work on a network?",
    "options": {
      "A": "The network uses a hub",
      "B": "The switch supports port mirroring",
      "C": "The NIC is in monitor mode",
      "D": "The attacker is on the same broadcast domain"
    },
    "correct_answers": ["A", "D"],
    "explanation": "Passive sniffing works best on hub-based networks or when on the same broadcast domain."
  },
  {
    "question": "What types of data are commonly captured during a successful sniffing attack?",
    "options": {
      "A": "Session tokens",
      "B": "Cleartext credentials",
      "C": "Private key files",
      "D": "DNS query logs"
    },
    "correct_answers": ["A", "B", "D"],
    "explanation": "Sniffers can easily extract credentials, session data, and DNS queries if not encrypted."
  },
  {
    "question": "Which tools allow for sniffing encrypted traffic for analysis?",
    "options": {
      "A": "Wireshark (with key)",
      "B": "SSLsplit",
      "C": "ssldump",
      "D": "Cain & Abel"
    },
    "correct_answers": ["A", "B", "C", "D"],
    "explanation": "These tools can either decrypt captured SSL traffic (if keys are known) or perform MITM to sniff it."
  },
  {
    "question": "What distinguishes monitor mode from promiscuous mode?",
    "options": {
      "A": "Monitor mode is used for wireless networks",
      "B": "Promiscuous mode is used for wired networks",
      "C": "Monitor mode captures all wireless frames",
      "D": "Promiscuous mode requires authentication"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Monitor mode captures raw 802.11 frames on wireless, while promiscuous is for Ethernet."
  },
  {
    "question": "Which techniques are commonly used in active sniffing?",
    "options": {
      "A": "ARP poisoning",
      "B": "MAC flooding",
      "C": "DNS spoofing",
      "D": "Session hijacking"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Active sniffing uses manipulation like ARP poisoning or DNS spoofing to intercept traffic."
  },
  {
    "question": "Which protocols are typically targeted during VoIP sniffing?",
    "options": {
      "A": "SIP",
      "B": "RTP",
      "C": "H.323",
      "D": "HTTPS"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "VoIP uses SIP, RTP, and H.323; HTTPS is unrelated to voice traffic."
  },
  {
    "question": "How does a packet sniffer typically operate on a switched Ethernet network?",
    "options": {
      "A": "By using ARP spoofing",
      "B": "By exploiting port mirroring",
      "C": "By performing MAC duplication",
      "D": "By relying on DNS rebinding"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "On switched networks, sniffers need tricks like ARP spoofing or mirrored ports to capture traffic."
  },
  {
    "question": "Which protocols are considered secure against sniffing if properly configured?",
    "options": {
      "A": "HTTPS",
      "B": "SFTP",
      "C": "Telnet",
      "D": "RDP"
    },
    "correct_answers": ["A", "B", "D"],
    "explanation": "Encrypted protocols like HTTPS, SFTP, and RDP resist sniffing; Telnet does not."
  },
  {
    "question": "What filtering option in Wireshark would display all TCP traffic?",
    "options": {
      "A": "tcp",
      "B": "tcp.port > 0",
      "C": "ip.proto == 6",
      "D": "tcp.flags.syn == 1"
    },
    "correct_answers": ["A", "B"],
    "explanation": "'tcp' and 'tcp.port > 0' are valid filters for capturing TCP traffic."
  },
  {
    "question": "What are consequences of successful sniffing attacks?",
    "options": {
      "A": "Credential theft",
      "B": "Session hijacking",
      "C": "Denial of Service",
      "D": "Network eavesdropping"
    },
    "correct_answers": ["A", "B", "D"],
    "explanation": "Sniffing typically results in eavesdropping, stolen credentials, or hijacked sessions—not DoS."
  },
  {
    "question": "Which layers of the OSI model do sniffing tools typically operate at?",
    "options": {
      "A": "Layer 2 (Data Link)",
      "B": "Layer 3 (Network)",
      "C": "Layer 4 (Transport)",
      "D": "Layer 7 (Application)"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Sniffers inspect traffic across multiple layers, especially 2–4, to extract useful metadata and payloads."
  },
  {
    "question": "Which of these tools are useful for DNS sniffing or manipulation?",
    "options": {
      "A": "Ettercap",
      "B": "dsniff",
      "C": "Wireshark",
      "D": "Cain & Abel"
    },
    "correct_answers": ["A", "B", "C", "D"],
    "explanation": "All listed tools support DNS sniffing or manipulation, often in MITM scenarios."
  },
  {
    "question": "Which wireless sniffing technique allows capturing handshake packets?",
    "options": {
      "A": "Monitor mode capture",
      "B": "Deauthentication attack",
      "C": "Passive scanning",
      "D": "Beacon flooding"
    },
    "correct_answers": ["A", "B"],
    "explanation": "Monitor mode + deauth attacks allow attackers to capture handshakes for cracking WPA/WPA2."
  },
  {
    "question": "What data can be extracted from sniffed HTTP packets?",
    "options": {
      "A": "Cookies",
      "B": "Login credentials",
      "C": "URLs and headers",
      "D": "Private keys"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "HTTP traffic is unencrypted, exposing cookies, credentials, and browsing behavior."
  },
  {
    "question": "Which of the following help detect sniffers in a network?",
    "options": {
      "A": "ARP ping with fake MACs",
      "B": "Packet delay analysis",
      "C": "Promiscuous mode probe",
      "D": "Monitor DHCP responses"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Detecting sniffers involves probing network behavior and NIC mode detection techniques."
  },
  {
    "question": "Which of these indicate a system may be in promiscuous mode?",
    "options": {
      "A": "Responds to packets not addressed to it",
      "B": "Fails to respond to ARP probes",
      "C": "Captures broadcast-only packets",
      "D": "Shows no MAC address"
    },
    "correct_answers": ["A"],
    "explanation": "In promiscuous mode, a system processes all packets, not just those addressed to it."
  },
  {
    "question": "What countermeasures can stop ARP poisoning-based sniffing?",
    "options": {
      "A": "Use static ARP tables",
      "B": "Use encrypted communication",
      "C": "Enable dynamic ARP inspection",
      "D": "Switch to IPv6"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Static ARP, encryption, and DAI help prevent or mitigate ARP-based sniffing attacks."
  },
  {
    "question": "Which file format is used by Wireshark and Tcpdump for packet captures?",
    "options": {
      "A": ".pcap",
      "B": ".cap",
      "C": ".dump",
      "D": ".pkt"
    },
    "correct_answers": ["A", "B"],
    "explanation": ".pcap and .cap are commonly used by sniffer tools for storing captured traffic."
  },
  {
    "question": "Which of these represent real-world uses of sniffing in pen testing?",
    "options": {
      "A": "Harvesting NTLM hashes",
      "B": "Capturing database credentials",
      "C": "Collecting cleartext passwords",
      "D": "Flooding access points"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Sniffing helps harvest sensitive data in assessments; flooding is a DoS tactic, not sniffing."
  },
  {
    "question": "Which protocols are considered unsecure and should be avoided on enterprise networks?",
    "options": {
      "A": "Telnet",
      "B": "HTTP",
      "C": "FTP",
      "D": "SMBv1"
    },
    "correct_answers": ["A", "B", "C", "D"],
    "explanation": "All listed protocols transmit data insecurely and are common targets for sniffing or exploitation."
  },
  {
    "question": "Which of the following are indicators of an ongoing ARP poisoning attack?",
    "options": {
      "A": "Frequent ARP broadcasts from unknown MACs",
      "B": "Duplicate IP addresses in the ARP cache",
      "C": "Sudden traffic rerouting",
      "D": "DNS lookup failures"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "ARP poisoning may cause unusual ARP traffic, duplicate IP-to-MAC entries, and rerouted packets."
  },
  {
    "question": "What are common results of DNS spoofing when used with sniffing?",
    "options": {
      "A": "Redirecting users to malicious sites",
      "B": "Capturing credentials from fake login pages",
      "C": "Altering email routes",
      "D": "Blocking HTTPS access"
    },
    "correct_answers": ["A", "B"],
    "explanation": "DNS spoofing misdirects users to attacker-controlled pages for data interception."
  },
  {
    "question": "Which protocols send data in cleartext by default?",
    "options": {
      "A": "FTP",
      "B": "POP3",
      "C": "Telnet",
      "D": "SCP"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "FTP, POP3, and Telnet transmit data unencrypted; SCP uses SSH and is encrypted."
  },
  {
    "question": "Which of the following can be captured from SMBv1 sessions during sniffing?",
    "options": {
      "A": "NTLMv1 hashes",
      "B": "File share names",
      "C": "Username information",
      "D": "Kerberos tickets"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "SMBv1 leaks usernames, shares, and weak NTLM hashes; Kerberos is used in more secure environments."
  },
  {
    "question": "What are advantages of using TShark over Wireshark?",
    "options": {
      "A": "Lightweight for CLI automation",
      "B": "Useful for headless systems",
      "C": "Lower memory usage",
      "D": "Built-in traffic decryption"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "TShark is a CLI tool for packet capture, ideal for scripting and low-resource environments."
  },
  {
    "question": "Which actions can prevent packet sniffing on a wireless network?",
    "options": {
      "A": "Using WPA3 encryption",
      "B": "Enabling client isolation",
      "C": "Disabling SSID broadcast",
      "D": "MAC address filtering"
    },
    "correct_answers": ["A", "B"],
    "explanation": "WPA3 and client isolation help protect data; hiding SSIDs and MAC filtering offer minimal real security."
  },
  {
    "question": "Which techniques are used by attackers to force reauthentication in sniffing attacks?",
    "options": {
      "A": "Deauthentication packets",
      "B": "Session reset (RST) injection",
      "C": "IP spoofing",
      "D": "Man-in-the-middle delay injection"
    },
    "correct_answers": ["A", "B"],
    "explanation": "Deauth and TCP resets force users to reconnect, potentially exposing credentials or session tokens."
  },
  {
    "question": "Which are valid reasons for ethical sniffing during a penetration test?",
    "options": {
      "A": "Capturing sensitive unencrypted data",
      "B": "Identifying vulnerable protocols in use",
      "C": "Validating encryption effectiveness",
      "D": "Disrupting user traffic"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Ethical sniffing aims to assess data exposure, weak protocols, and test defensive configurations."
  },
  {
    "question": "Which of these are default filter options in Wireshark?",
    "options": {
      "A": "ip.addr",
      "B": "http.request",
      "C": "tcp.flags.syn",
      "D": "arp.hw.type"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Wireshark supports filters by protocol, TCP flags, IPs, and much more for precise capture analysis."
  },
  {
    "question": "Which commands or tools can help verify if a NIC is in promiscuous mode?",
    "options": {
      "A": "ifconfig",
      "B": "ip link show",
      "C": "netstat -i",
      "D": "tcpdump"
    },
    "correct_answers": ["A", "B", "D"],
    "explanation": "ifconfig and 'ip link' show NIC flags; tcpdump can force promiscuous mode for sniffing."
  },
  {
    "question": "Which network configurations help reduce the impact of sniffing?",
    "options": {
      "A": "Port isolation",
      "B": "Private VLANs",
      "C": "Full-duplex links",
      "D": "Static IP addressing"
    },
    "correct_answers": ["A", "B"],
    "explanation": "Private VLANs and port isolation limit broadcast traffic to attackers on the same subnet."
  },
  {
    "question": "Which are outputs a sniffer like Wireshark may display?",
    "options": {
      "A": "MAC addresses",
      "B": "TCP flags",
      "C": "Sequence numbers",
      "D": "Encrypted payloads in plaintext"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Wireshark reveals packet headers, TCP flags, sequence numbers, and MAC addresses. Encrypted payloads cannot be read."
  },
  {
    "question": "Which protocols commonly use TCP port 110, 21, and 23 respectively?",
    "options": {
      "A": "POP3",
      "B": "FTP",
      "C": "Telnet",
      "D": "HTTPS"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "POP3 = 110, FTP = 21, Telnet = 23. All are insecure without encryption layers."
  },
  {
    "question": "Which of the following are common in packet replay attacks?",
    "options": {
      "A": "Captured authentication requests",
      "B": "ARP request packets",
      "C": "Malicious DNS responses",
      "D": "VoIP call packets"
    },
    "correct_answers": ["A", "B", "D"],
    "explanation": "Packet replay can reuse authentication and VoIP data or flood the network with ARP requests."
  },
  {
    "question": "Which of these sniffing tools support plugin-based extensibility?",
    "options": {
      "A": "Ettercap",
      "B": "Wireshark",
      "C": "Burp Suite",
      "D": "Cain & Abel"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Ettercap and Wireshark support user scripts/plugins; Burp has many modules. Cain is not plugin-based."
  },
  {
    "question": "Which information can an attacker extract by sniffing LDAP queries?",
    "options": {
      "A": "Username structures",
      "B": "Active Directory paths",
      "C": "Encrypted password hashes",
      "D": "Group memberships"
    },
    "correct_answers": ["A", "B", "D"],
    "explanation": "If LDAP traffic is unencrypted, it can leak directory paths, user names, and group info."
  },
  {
    "question": "Which transport-layer protocol is typically the target in TCP session hijacking via sniffing?",
    "options": {
      "A": "TCP",
      "B": "UDP",
      "C": "ICMP",
      "D": "ARP"
    },
    "correct_answers": ["A"],
    "explanation": "TCP’s connection-oriented structure makes it vulnerable to hijacking when sequence numbers are sniffed."
  },
  {
    "question": "What methods are used to trigger user traffic for sniffing capture?",
    "options": {
      "A": "Fake login prompts",
      "B": "Phishing emails",
      "C": "Deauthentication floods",
      "D": "ARP request flooding"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Triggering user interaction helps sniffers capture valuable data like credentials or session cookies."
  },
  {
    "question": "Which of the following use packet injection in combination with sniffing?",
    "options": {
      "A": "Ettercap",
      "B": "Aircrack-ng",
      "C": "Metasploit",
      "D": "Wireshark"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Ettercap, Aircrack-ng, and Metasploit can inject and sniff; Wireshark is passive only."
  },
  {
    "question": "Which forms of sniffing work best on unsegmented Layer 2 networks?",
    "options": {
      "A": "Passive sniffing",
      "B": "MAC flooding",
      "C": "Switch port stealing",
      "D": "SSL stripping"
    },
    "correct_answers": ["A", "B", "C"],
    "explanation": "Layer 2 attacks like passive sniffing and switch manipulation are most effective on flat, unsegmented networks."
  }
]
